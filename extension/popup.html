<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube字幕翻译器</title>
    <link rel="stylesheet" href="popup.css">
</head>

<body>
    <div class="container">
        <!-- 精简的标题栏 -->
        <div class="header">
            <div class="header-content">
                <div class="app-info">
                    <h1>🎬 字幕翻译</h1>
                    <span class="version">v1.1.0</span>
                </div>
            </div>
        </div>

        <!-- 标签页导航 -->
        <div class="tab-navigation">
            <button class="tab-button active" data-tab="files">
                <span class="tab-icon">📁</span>
                <span class="tab-text">字幕管理</span>
            </button>
            <button class="tab-button" data-tab="api">
                <span class="tab-icon">🔑</span>
                <span class="tab-text">API设置</span>
            </button>
            <button class="tab-button" data-tab="settings">
                <span class="tab-icon">⚙️</span>
                <span class="tab-text">样式设定</span>
            </button>
            <button class="tab-button" data-tab="about">
                <span class="tab-icon">ℹ️</span>
                <span class="tab-text">关于</span>
            </button>
        </div>

        <!-- 标签页内容 -->
        <div class="main-content">
            <!-- 文件管理标签页 -->
            <div class="tab-content active" id="filesTab">
                <!-- 字幕统计区域 -->
                <div class="subtitle-stats">
                    <div class="status-card">
                        <div class="status-content">
                            <div class="status-info">
                                <span class="status-flag">🇺🇸</span>
                                <span class="status-label">英文</span>
                                <span class="status-count" id="englishCount">0条</span>
                            </div>
                            <div class="status-divider"></div>
                            <div class="status-info">
                                <span class="status-flag">🇨🇳</span>
                                <span class="status-label">中文</span>
                                <span class="status-count" id="chineseCount">0条</span>
                            </div>
                        </div>
                        <div class="action-buttons">
                            <button class="action-btn clear-btn" id="clearButton" title="清除所有字幕">
                                <span>🗑️</span>
                            </button>
                            <button class="action-btn reset-btn" id="forceResetButton" title="重置扩展">
                                <span>🔄</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 字幕来源选择 -->
                <div class="subtitle-source-section">
                    <div class="source-header">
                        <span class="source-title">📝 字幕来源</span>
                    </div>
                    <div class="source-options">
                        <label class="source-option active">
                            <input type="radio" name="subtitleSource" value="youtube" checked>
                            <span class="option-icon">🎬</span>
                            <span class="option-text">YouTube 字幕</span>
                        </label>
                        <label class="source-option">
                            <input type="radio" name="subtitleSource" value="upload">
                            <span class="option-icon">📄</span>
                            <span class="option-text">上传 SRT</span>
                        </label>
                    </div>
                </div>

                <!-- SRT 上传区域 (默认隐藏) -->
                <div class="srt-upload-section" id="srtUploadSection" style="display: none;">
                    <div class="srt-drop-zone" id="srtUploadArea">
                        <div class="srt-drop-content">
                            <span class="srt-icon">📄</span>
                            <span class="srt-text">拖拽 SRT 文件或点击选择</span>
                        </div>
                        <input type="file" id="srtFileInput" accept=".srt" hidden>
                    </div>
                    <div class="srt-file-info" id="srtFileInfo" style="display: none;">
                        <span class="srt-filename" id="srtFileName"></span>
                        <button class="srt-remove" id="srtRemove">×</button>
                    </div>
                </div>

                <!-- 翻译控制区域 -->
                <div class="translate-control-section">
                    <!-- 当前视频信息 -->
                    <div class="video-info-card">
                        <div class="info-row">
                            <span class="info-label">🎬 当前视频</span>
                            <span class="info-value" id="currentVideoId">未检测到视频</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">📊 状态</span>
                            <span class="info-value" id="autoLoadStatus">等待开始</span>
                        </div>
                        <div class="progress-row" id="progressRow" style="display: none;">
                            <div class="progress-bar">
                                <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
                            </div>
                            <span class="progress-text" id="progressText">0%</span>
                        </div>
                    </div>

                    <!-- 翻译按钮 -->
                    <button class="translate-main-btn" id="translateBtn">
                        <span class="btn-icon">🚀</span>
                        <span class="btn-text">开始翻译</span>
                    </button>
                </div>
            </div>

            <!-- API设置标签页 -->
            <div class="tab-content" id="apiTab">
                <div class="settings-card">
                    <div class="settings-header">
                        <span>🔑 API 配置</span>
                    </div>

                    <div class="settings-grid">
                        <!-- API Base URL -->
                        <div class="setting-item">
                            <div class="setting-label">
                                <span class="setting-icon">🌐</span>
                                <span class="setting-name">API Base URL</span>
                            </div>
                            <input type="text" id="apiBaseUrl" class="config-input"
                                placeholder="https://api.openai.com/v1" value="https://api.openai.com/v1">
                        </div>

                        <!-- API Key -->
                        <div class="setting-item">
                            <div class="setting-label">
                                <span class="setting-icon">🔐</span>
                                <span class="setting-name">API Key</span>
                            </div>
                            <div class="api-key-input-wrapper">
                                <input type="password" id="apiKey" class="config-input" placeholder="sk-...">
                                <button class="toggle-visibility" id="toggleApiKeyVisibility" title="显示/隐藏">
                                    👁️
                                </button>
                            </div>
                        </div>

                        <!-- LLM Model -->
                        <div class="setting-item">
                            <div class="setting-label">
                                <span class="setting-icon">🤖</span>
                                <span class="setting-name">翻译模型</span>
                            </div>
                            <input type="text" id="llmModel" class="config-input" placeholder="输入模型名称" value="">
                        </div>

                        <!-- Target Language -->
                        <div class="setting-item">
                            <div class="setting-label">
                                <span class="setting-icon">🌍</span>
                                <span class="setting-name">目标语言</span>
                            </div>
                            <select id="targetLanguage" class="setting-select">
                                <!-- 动态填充 -->
                            </select>
                        </div>
                    </div>

                    <!-- 操作按钮 -->
                    <div class="api-actions">
                        <button class="action-btn test-api-btn" id="testApiBtn">
                            <span>🔍</span>
                            <span>测试连接</span>
                        </button>
                        <button class="action-btn save-api-btn" id="saveApiBtn">
                            <span>💾</span>
                            <span>保存配置</span>
                        </button>
                    </div>

                    <!-- API状态显示 -->
                    <div class="api-status" id="apiStatus" style="display: none;">
                        <span class="api-status-icon" id="apiStatusIcon">✓</span>
                        <span class="api-status-text" id="apiStatusText">API连接成功</span>
                    </div>
                </div>

                <!-- 使用说明 -->
                <div class="tips-card">
                    <div class="tips-header">
                        <span>💡 配置说明</span>
                    </div>
                    <div class="tip-item">
                        <span class="tip-number">1</span>
                        <span class="tip-text">支持OpenAI及兼容API（如Azure、OpenRouter）</span>
                    </div>
                    <div class="tip-item">
                        <span class="tip-number">2</span>
                        <span class="tip-text">API Key将安全存储在本地浏览器中</span>
                    </div>
                    <div class="tip-item">
                        <span class="tip-number">3</span>
                        <span class="tip-text">可选择预设模型或输入自定义模型名称</span>
                    </div>
                </div>
            </div>

            <!-- 样式设定标签页 -->
            <div class="tab-content" id="settingsTab">
                <!-- 语言切换区 -->
                <div class="language-switcher">
                    <div class="switch-header">
                        <span class="switch-label">当前语言</span>
                    </div>
                    <div class="language-buttons">
                        <button class="lang-btn active" data-lang="english" id="englishTab">
                            <span class="lang-flag">🇺🇸</span>
                            <span class="lang-name">English</span>
                        </button>
                        <button class="lang-btn" data-lang="chinese" id="chineseTab">
                            <span class="lang-flag">🇨🇳</span>
                            <span class="lang-name">中文</span>
                        </button>
                    </div>
                </div>

                <!-- 详细设置 -->
                <div class="settings-card">
                    <div class="settings-header">
                        <span>⚙️ 详细设置</span>
                        <button class="reset-btn" id="resetSettings" title="恢复默认">
                            <span>🔄</span>
                        </button>
                    </div>

                    <div class="settings-grid">
                        <!-- 字体大小 -->
                        <div class="setting-item">
                            <div class="setting-label">
                                <span class="setting-icon">📏</span>
                                <span class="setting-name">字体大小</span>
                                <span class="setting-value" id="fontSizeValue">30px</span>
                            </div>
                            <input type="range" id="fontSize" min="16" max="72" value="30" class="setting-slider">
                        </div>

                        <!-- 字体颜色 -->
                        <div class="setting-item">
                            <div class="setting-label">
                                <span class="setting-icon">🎨</span>
                                <span class="setting-name">字体颜色</span>
                                <span class="color-preview" id="colorPreview"></span>
                            </div>
                            <div class="color-selector">
                                <select id="fontColorPreset" class="setting-select">
                                    <option value="#ffffff">白色</option>
                                    <option value="#ffff00">黄色</option>
                                    <option value="#00ff00">绿色</option>
                                    <option value="#ff0000">红色</option>
                                    <option value="#0000ff">蓝色</option>
                                    <option value="#ffa500">橙色</option>
                                    <option value="#800080">紫色</option>
                                    <option value="#ffc0cb">粉色</option>
                                    <option value="custom">自定义...</option>
                                </select>
                                <input type="color" id="fontColor" value="#ffffff" class="color-picker"
                                    style="display: none;">
                            </div>
                        </div>

                        <!-- 字体类型 -->
                        <div class="setting-item">
                            <div class="setting-label">
                                <span class="setting-icon">🎭</span>
                                <span class="setting-name">字体类型</span>
                            </div>
                            <select id="fontFamily" class="setting-select">
                                <!-- 动态填充 -->
                            </select>
                        </div>

                        <!-- 字体粗细 -->
                        <div class="setting-item">
                            <div class="setting-label">
                                <span class="setting-icon">💪</span>
                                <span class="setting-name">字体粗细</span>
                            </div>
                            <select id="fontWeight" class="setting-select">
                                <option value="300">细体</option>
                                <option value="400">正常</option>
                                <option value="700" selected>粗体</option>
                                <option value="900">最粗</option>
                            </select>
                        </div>

                    </div>
                </div>
            </div>

            <!-- 关于标签页 -->
            <div class="tab-content" id="aboutTab">
                <div class="about-card">
                    <div class="app-logo">
                        <div class="logo-icon">🎬</div>
                        <div class="logo-text">
                            <h3>YouTube 字幕翻译</h3>
                            <span class="version">v1.1.0</span>
                        </div>
                    </div>

                    <div class="feature-list">
                        <div class="feature-item">
                            <span class="feature-icon">🤖</span>
                            <span class="feature-text">AI 智能翻译</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">🌍</span>
                            <span class="feature-text">双语字幕显示</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">🎨</span>
                            <span class="feature-text">自定义样式</span>
                        </div>
                    </div>

                    <div class="about-actions">
                        <button class="about-btn" id="helpLink">
                            <span>❓</span>
                            <span>使用帮助</span>
                        </button>
                        <button class="about-btn" id="feedbackLink">
                            <span>📨</span>
                            <span>反馈意见</span>
                        </button>
                    </div>
                </div>

                <div class="tips-card">
                    <div class="tips-header">
                        <span>💡 使用技巧</span>
                    </div>
                    <div class="tip-item">
                        <span class="tip-number">1</span>
                        <span class="tip-text">支持 SRT、VTT、ASS 格式字幕文件</span>
                    </div>
                    <div class="tip-item">
                        <span class="tip-number">2</span>
                        <span class="tip-text">全屏模式下效果更佳</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 配置必须在其他脚本之前加载 -->
    <script src="config.js"></script>
    <script src="translator.js"></script>
    <script src="subtitle-parser.js"></script>
    <script src="popup.js"></script>
</body>

</html>